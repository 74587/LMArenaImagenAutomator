# LMArenaImagenAutomator

## ğŸ“ é¡¹ç›®ç®€ä»‹

LMArenaImagenAutomator æ˜¯ä¸€ä¸ªåŸºäº Playwright + Camoufox çš„è‡ªåŠ¨åŒ–å›¾åƒç”Ÿæˆå·¥å…·ï¼Œé€šè¿‡æ¨¡æ‹Ÿäººç±»æ“ä½œä¸ LMArenaã€Gemini ç­‰ç½‘ç«™äº¤äº’æä¾›å›¾åƒç”ŸæˆæœåŠ¡åˆ°OpenAIæ ¼å¼çš„æ¥å£ã€‚(æœªæ¥å¯èƒ½æ”¯æŒæ›´å¤šæ”¯æŒå…è´¹ç”Ÿå›¾çš„ç½‘ç«™)

å½“å‰æ”¯æŒçš„ç½‘ç«™ï¼š
  - LMArena
  - Gemini Enterprise Business
  - Nano Banana Free

### âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸ’â€â™‚ï¸ **æ‹Ÿäººæ“ä½œ**ï¼šæ¨¡æ‹Ÿäººç±»é¼ æ ‡ç§»åŠ¨è½¨è¿¹å’ŒæŠ–åŠ¨è¡Œä¸º
- ğŸ¤– **æ™ºèƒ½è¾“å…¥**ï¼šæ¨¡æ‹Ÿäººç±»æ‰“å­—é€Ÿåº¦å’Œé”™è¯¯çº æ­£è¡Œä¸º
- ğŸ–¼ï¸ **å¤šå›¾æ”¯æŒ**ï¼šæœ€å¤šæ”¯æŒåŒæ—¶ä¸Šä¼  10 å¼ å‚è€ƒå›¾ç‰‡
- ğŸ“Š **é˜Ÿåˆ—ç®¡ç†**ï¼šæ”¯æŒä»»åŠ¡é˜Ÿåˆ—ï¼Œé˜²æ­¢è¯·æ±‚è¿‡è½½æˆ–è¶…æ—¶
- ğŸŒ **ä»£ç†æ”¯æŒ**ï¼šæ”¯æŒ HTTP å’Œ SOCKS5 ä»£ç†é…ç½®
- ğŸ­ **ç‰¹å¾ä¼ªè£…**ï¼šå°½é‡ä¼ªè£…æˆéè‡ªåŠ¨ç¨‹åºæ§åˆ¶çš„æµè§ˆå™¨
- ğŸ”— **æµå¼ä¿æ´»**ï¼šå¤ç”¨æ ‡å‡†æ¥å£çš„æµå¼æ¨¡å¼å‘é€å¿ƒè·³åŒ…

![Image](https://github.com/user-attachments/assets/81170a77-e377-4b47-a2a4-009878142a28)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç³»ç»Ÿè¦æ±‚

- **Node.js**: 20.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬ (ABI 115+)
- **æ“ä½œç³»ç»Ÿ**: Windowsã€Linux æˆ– MacOS
- **æµè§ˆå™¨**: Camoufox (ç»è¿‡åæ£€æµ‹å¤„ç†çš„FireFoxæµè§ˆå™¨)
> **å¼€å‘ç¯å¢ƒå‚è€ƒ**
> - Node.js v22.20.0 ( Windows 10 )
> - Node.js v20.19.0 ( Debian 12 )

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®** æˆ–ä¸‹è½½è§£å‹é¡¹ç›®æ–‡ä»¶

2. **é…ç½®æ–‡ä»¶**
  å¤åˆ¶é…ç½®æ–‡ä»¶æ¨¡æ¿è¿›è¡Œé…ç½®æ–‡ä»¶çš„ä¿®æ”¹
   ```
   cp config.example.yaml config.yaml
   ```

3. **å®‰è£…ä¾èµ–**
   ```bash
   # å®‰è£… NPM åŸºæœ¬ä¾èµ–
   pnpm install

   # å®‰è£…æ‰€éœ€é¢å¤–ä¾èµ–
   # è‡ªåŠ¨ä¸‹è½½å®‰è£…æ‰€éœ€çš„æµè§ˆå™¨å’ŒNPMé¢„ç¼–è¯‘æ–‡ä»¶
   # è‹¥ç½‘ç»œæ— æ³•è¿æ¥ GitHubï¼Œè¯·æå‰åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®å¯ç”¨ä»£ç†
   npm run init
   ```

4. **å¯åŠ¨ç¨‹åº**
   ```bash
   # æ ‡å‡†æ¨¡å¼
   npm start

   # ç™»å½•æ¨¡å¼ (ç”¨äºæ‰‹åŠ¨ç™»å½•ï¼Œè¯¥æ¨¡å¼ä¼šè‡ªåŠ¨ç¦ç”¨è‡ªåŠ¨åŒ–å’Œæ— å¤´æ¨¡å¼)
   npm start -- -login
   ```

5. **æµ‹è¯•ç¨‹åº (å¯é€‰)**
   ç”¨äºå¿«é€Ÿæµ‹è¯•æœåŠ¡å™¨æ¥å£
   ```bash
   npm test
   ```
---

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### âš ï¸ é¦–æ¬¡ä½¿ç”¨é‡è¦æŒ‡å¼•

#### 1. å¯åŠ¨ä¸ç™»å½•
- **å…³é—­æ— å¤´æ¨¡å¼**ï¼šé¦–æ¬¡å¯åŠ¨åŠ¡å¿…å…³é—­æ— å¤´æ¨¡å¼ã€‚æ¨èä½¿ç”¨ **ç™»å½•æ¨¡å¼**ã€‚ï¼ˆLinux å‘½ä»¤è¡Œç”¨æˆ·è¯·å‚é˜…æ–‡æ¡£ç»“å°¾ï¼‰
- **æ‰‹åŠ¨ç™»å½•**ï¼šç½‘é¡µåŠ è½½å®Œæ¯•åï¼Œè¯·æ‰‹åŠ¨å®Œæˆè´¦å·ç™»å½•ã€‚

#### 2. éªŒè¯æµç¨‹
- **è§¦å‘éªŒè¯**ï¼šåœ¨è¾“å…¥æ¡†è¾“å…¥ä»»æ„å†…å®¹å¹¶å‘é€ï¼Œè§¦å‘æœåŠ¡æ¡æ¬¾åŠ CloudFlare Turnstile éªŒè¯ã€‚
- **å®ŒæˆéªŒè¯**ï¼šç‚¹å‡»éªŒè¯ç å¹¶é€šè¿‡ï¼ˆå¯èƒ½åŒ…å« reCAPTCHAï¼‰ï¼ŒåŒæ„æ¡æ¬¾åå†æ¬¡ç‚¹å‡»å‘é€ç¡®ä¿æµç¨‹é€šç•…ã€‚

#### 3. è¿è¡Œå»ºè®®
- **æ¨¡å¼é€‰æ‹©**ï¼šå®Œæˆä¸Šè¿°åˆå§‹åŒ–åï¼Œå¯åˆ‡æ¢è‡³æ— å¤´æ¨¡å¼è¿è¡Œã€‚
- **æœ€ä½³å®è·µ**ï¼šä¸ºé™ä½é£æ§æ¦‚ç‡ï¼Œ**å¼ºçƒˆå»ºè®®**ä¿æŒéæ— å¤´æ¨¡å¼è¿è¡Œã€‚


### æ¥å£ä½¿ç”¨è¯´æ˜

#### 1. OpenAI å…¼å®¹æ¥å£

> [!WARNING]
> ç”±äºæ¨¡æ‹ŸçœŸå®æµè§ˆå™¨æ“ä½œï¼Œæ¯æ¬¡åªèƒ½å¤„ç†ä¸€ä¸ªä»»åŠ¡ï¼Œå…¶ä½™ä»»åŠ¡å°†è¿›å…¥é˜Ÿåˆ—ç­‰å¾…ã€‚ä¸ºé¿å…å®¢æˆ·ç«¯è¶…æ—¶å½±å“ä½“éªŒï¼Œè‹¥å½“å‰ä»»åŠ¡æ•°å·²è¾¾3ä¸ªï¼Œåç»­è¯·æ±‚å°†ç›´æ¥è¿”å›é”™è¯¯ã€‚å› æ­¤ï¼Œå¼ºçƒˆæ¨èå¼€å¯æµå¼ä¿æ´»ï¼Œè¯¥æ¨¡å¼ä¸‹æœåŠ¡å™¨ä¼šå‘å®¢æˆ·ç«¯å‘é€ä¿æ´»æ³¨é‡Šæˆ–è€…å¿ƒè·³åŒ…ä»¥ç¡®ä¿è¿æ¥æŒç»­æ´»è·ƒã€‚

**è¯·æ±‚ç«¯ç‚¹**
```
POST http://127.0.0.1:3000/v1/chat/completions
```

<details>
<summary>ğŸ“„ æŸ¥çœ‹APIè¯·æ±‚ç¤ºä¾‹</summary>

**è¯·æ±‚ç¤ºä¾‹ï¼ˆéæµå¼ï¼‰**
```bash
curl -X POST http://127.0.0.1:3000/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your-secret-key" \
  -d '{
    "model": "gemini-3-pro-image-preview",
    "messages": [
      {
        "role": "user",
        "content": [
          {
            "type": "text",
            "text": "generate a cat"
          }
      ]
      }
    ]
  }'
```

**å“åº”æ ¼å¼ï¼ˆéæµå¼ï¼‰**
```json
{
  "id": "chatcmpl-1732374740123",
  "object": "chat.completion",
  "created": 1732374740,
  "model": "gemini-3-pro-image-preview",
  "choices": [{
    "index": 0,
    "message": {
      "role": "assistant",
      "content": "![generated](data:image/jpeg;base64,/9j/4AAQ...)"
    },
    "finish_reason": "stop"
  }]
}
```

**è¯·æ±‚ç¤ºä¾‹ï¼ˆæµå¼ - æ¨èï¼‰**
```bash
curl -X POST http://127.0.0.1:3000/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer your-secret-key" \
  -d '{
    "model": "gemini-3-pro-image-preview",
    "stream": true,
    "messages": [
      {
        "role": "user",
        "content": "generate a cat"
      }
    ]
  }'
```

**å“åº”æ ¼å¼ï¼ˆæµå¼ï¼‰**
```
data: {"id":"chatcmpl-1732374740123","object":"chat.completion.chunk","created":1732374740,"model":"gemini-3-pro-image-preview","choices":[{"index":0,"delta":{"role":"assistant","content":""},"finish_reason":null}]}

: keep-alive
: keep-alive

data: {"id":"chatcmpl-1732374740123","object":"chat.completion.chunk","created":1732374740,"model":"gemini-3-pro-image-preview","choices":[{"index":0,"delta":{"content":"![generated](data:image/jpeg;base64,/9j/4AAQ...)"},"finish_reason":"stop"}]}

data: [DONE]
```
</details>

> **å…³äº `model` å‚æ•°**ï¼š
> - **å¿…å¡«**ï¼šå¿…é¡»å¡«å†™æ”¯æŒçš„æ¨¡å‹åç§°ï¼Œå¦åˆ™å°†ä½¿ç”¨ç›®æ ‡ç½‘ç«™çš„é»˜è®¤æ¨¡å‹
> - **æŸ¥çœ‹å¯ç”¨æ¨¡å‹**ï¼š
>   - æ–¹å¼ 1ï¼šè®¿é—® `/v1/models` æ¥å£æŸ¥è¯¢
>   - æ–¹å¼ 2ï¼šç›´æ¥æŸ¥çœ‹ `lib/backend/models.js` æ–‡ä»¶
> - **ç¤ºä¾‹æ¨¡å‹**ï¼š`gemini-3-pro-image-preview`ã€`seedream-4-high-res-fal`ã€`dall-e-3` ç­‰

> **å…³äºæµå¼ä¿æ´»çš„å¿ƒè·³æ¨¡å¼**ï¼š
> - ä¸»è¦åˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼Œå¯è‡ªè¡Œåœ¨é…ç½®æ–‡æ¡£ä¸­æ ¹æ®æ‰€éœ€åˆ‡æ¢
>   - commentæ¨¡å¼: å‘é€ :keepalive æ³¨é‡Šã€‚ä¸æ±¡æŸ“æ•°æ®ï¼Œç»å¤§å¤šæ•° SDK æ”¯æŒï¼Œä¸ä¼šå½±å“æ¥å£æ ‡å‡†
>   - contentæ¨¡å¼: åœ¨ choices[0].delta.content = "" ä¸­å‘é€ç©ºå­—ç¬¦ä¸²ï¼ˆä»…å½“ä½ ä½¿ç”¨çš„å®¢æˆ·ç«¯éå¸¸ç‰¹æ®Šï¼Œå¿…é¡»æ”¶åˆ° data JSON åŒ…æ‰é‡ç½®è¶…æ—¶æ—¶ä½¿ç”¨ï¼‰

#### 2. è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨

**è¯·æ±‚ç«¯ç‚¹**
```
GET http://127.0.0.1:3000/v1/models
```

<details>
<summary>ğŸ“„ æŸ¥çœ‹APIè¯·æ±‚ç¤ºä¾‹</summary>

**è¯·æ±‚ç¤ºä¾‹**
```bash
curl -X GET http://127.0.0.1:3000/v1/models \
  -H "Authorization: Bearer your-secret-key"
```

**å“åº”æ ¼å¼**
```json
{
  "object": "list",
  "data": [
    {
      "id": "seedream-4-high-res-fal",
      "object": "model",
      "created": 1732456789,
      "owned_by": "lmarena"
    },
    {
      "id": "gemini-3-pro-image-preview",
      "object": "model",
      "created": 1732456789,
      "owned_by": "lmarena"
    }
  ]
}
```

</details>

#### 3. å¸¦å›¾ç‰‡çš„è¯·æ±‚è¯´æ˜

**æ”¯æŒæ ¼å¼**ï¼šPNGã€JPEGã€GIFã€WebP  
**æœ€å¤§æ•°é‡**ï¼š5 å¼ å›¾ç‰‡  
**æ•°æ®æ ¼å¼**ï¼šBase64 ç¼–ç 

<details>
<summary>ğŸ“„ æŸ¥çœ‹APIè¯·æ±‚ç¤ºä¾‹</summary>

**è¯·æ±‚ç¤ºä¾‹**
```json
{
  "model": "gemini-3-pro-image-preview",
  "messages": [{
    "role": "user",
    "content": [
      {
        "type": "text",
        "text": "make it more colorful"
      },
      {
        "type": "image_url",
        "image_url": {
          "url": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAA..."
        }
      }
    ]
  }]
}
```

</details>

---

## ğŸ”§ å¸¸è§é—®é¢˜

<details>
<summary>âŒ è¯·æ±‚è¢«æ‹’ç» (429 Too Many Requests)</summary>

**é—®é¢˜**: å¹¶å‘è¯·æ±‚è¿‡å¤š

**è§£å†³æ–¹æ¡ˆ**:
- è¯¥é—®é¢˜ä»…å­˜åœ¨æœªå¼€å¯æµå¼ä¿æ´»æ—¶å‡ºç°
- é˜Ÿåˆ—é™åˆ¶ï¼š1 ä¸ªå¹¶å‘ + 2 ä¸ªæ’é˜Ÿ (æ€»è®¡ 3 ä¸ª)
- ä¿®æ”¹ `config.yaml` ä¸­çš„`queue.maxQueueSize` (ä¸å»ºè®®)
- ç­‰å¾…å½“å‰ä»»åŠ¡å®Œæˆåå†æäº¤æ–°ä»»åŠ¡

</details>

<details>
<summary>âŒ reCAPTCHA éªŒè¯å¤±è´¥</summary>

**é—®é¢˜**: è¿”å› `recaptcha validation failed`

**è§£å†³æ–¹æ¡ˆ**:
- è¿™æ˜¯ LMArena çš„äººæœºéªŒè¯æœºåˆ¶
- å»ºè®®ï¼š
  - é™ä½è¯·æ±‚é¢‘ç‡
  - é¦–æ¬¡ä½¿ç”¨æ—¶æ‰‹åŠ¨å®Œæˆä¸€æ¬¡éªŒè¯ (å…³é—­ headless æ¨¡å¼)
  - ä½¿ç”¨ç¨³å®šå’Œçº¯å‡€çš„ IP åœ°å€ (å¯ä½¿ç”¨ [ping0.cc](https://ping0.cc) æŸ¥è¯¢IPåœ°å€çº¯å‡€åº¦)

</details>

<details>
<summary>âŒ å›¾åƒç”Ÿæˆè¶…æ—¶</summary>

**é—®é¢˜**: ä»»åŠ¡è¶…è¿‡ 120 ç§’æœªå®Œæˆ

**è§£å†³æ–¹æ¡ˆ**:
- å¯ç”¨æµå¼ä¿æ´»ç¡®ä¿å®¢æˆ·ç«¯ä¸ä¼šä¸»åŠ¨æ–­å¼€è¿æ¥
- æ£€æŸ¥ç½‘ç»œè¿æ¥æ˜¯å¦ç¨³å®š
- æŸäº›å¤æ‚æç¤ºè¯å¯èƒ½éœ€è¦æ›´é•¿æ—¶é—´

</details>

<details>
<summary>ğŸ§ ã€Linux ç¯å¢ƒä¸‹éæ— å¤´æ¨¡å¼è¿è¡Œã€‘</summary>

**é—®é¢˜**: éœ€è¦åœ¨ Linux æœåŠ¡å™¨ä¸Šæ˜¾ç¤ºæµè§ˆå™¨ç•Œé¢ï¼ˆå¦‚æ‰‹åŠ¨è¿‡éªŒè¯ç ï¼‰

**è§£å†³æ–¹æ¡ˆ**:

**æ–¹æ³•ä¸€ï¼šX11 è½¬å‘**
- æ¨èä½¿ç”¨ WindTerm ç­‰ç»ˆç«¯å·¥å…·ï¼Œå¼€å¯ X-Server åŠŸèƒ½
- åœ¨ SSH ä¼šè¯è®¾ç½®ä¸­å¯ç”¨ X11 è½¬å‘ (Forward X11)

**æ–¹æ³•äºŒï¼šXvfb + X11VNC (æ¨è)**
ä½¿ç”¨è™šæ‹Ÿæ˜¾ç¤ºå™¨è¿è¡Œç¨‹åºï¼Œå¹¶é€šè¿‡ VNC è¿œç¨‹æŸ¥çœ‹ã€‚

1. **å¯åŠ¨è™šæ‹Ÿæ˜¾ç¤ºå™¨å¹¶è¿è¡Œç¨‹åº** (å±å¹•å· 99 å¯æŒ‰éœ€ä¿®æ”¹):
   ```bash
   xvfb-run --server-num=99 --server-args="-ac -screen 0 1920x1080x24" npm start
   ```

2. **å°†è™šæ‹Ÿæ˜¾ç¤ºå™¨æ˜ å°„è‡³ VNC**:
   ```bash
   x11vnc -display :99 -localhost -nopw -once -noxdamage -ncache 10 -forever
   ```

3. **å»ºç«‹ SSH éš§é“è¿æ¥ VNC** (å®‰å…¨æ¨è):
   ```bash
   # åœ¨æœ¬åœ°ç»ˆç«¯è¿è¡Œï¼Œå°†æœåŠ¡å™¨ 5900 ç«¯å£æ˜ å°„åˆ°æœ¬åœ°
   ssh -L 5900:127.0.0.1:5900 root@æœåŠ¡å™¨IP
   ```
   éšåä½¿ç”¨ VNC å®¢æˆ·ç«¯è¿æ¥ `127.0.0.1:5900` å³å¯ã€‚

</details>

---

## ğŸ“Š è®¾å¤‡é…ç½®
| èµ„æº | æœ€ä½é…ç½® | æ¨èé…ç½® |
|------|---------|---------|
| CPU | 1æ ¸ | 2æ ¸åŠä»¥ä¸Š |
| å†…å­˜ | 1GB | 2GB åŠä»¥ä¸Š |

ç»æµ‹è¯•ï¼Œæœ¬é¡¹ç›®å¯åœ¨ä»¥ä¸‹ç¯å¢ƒä¸­è¿è¡Œï¼š
- Oracle å…è´¹æœºï¼ˆæœ‰äº›å¡é¡¿ï¼Œå‹‰å¼ºèƒ½ç”¨ï¼‰ï¼š1C1G é…ç½®ï¼ŒåŸºäº Debian 12 ç³»ç»Ÿã€‚
- é˜¿é‡Œäº‘è½»é‡åº”ç”¨æœåŠ¡å™¨ï¼ˆå¼€å‘æµ‹è¯•æ‰€ç”¨ï¼‰ï¼š2C2G é…ç½®ï¼ŒåŸºäº Debian 11 ç³»ç»Ÿã€‚

## ğŸ“„ è®¸å¯è¯å’Œå…è´£å£°æ˜

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºã€‚

**å…è´£å£°æ˜**:
æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ã€‚å¦‚æœå› ä½¿ç”¨è¯¥é¡¹ç›®é€ æˆçš„ä»»ä½•åæœï¼ˆåŒ…æ‹¬ä½†ä¸ä»…é™äºè´¦å·è¢«ç¦ç”¨ï¼‰ï¼Œä½œè€…å’Œè¯¥é¡¹ç›®å‡ä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚è¯·éµå®ˆç›¸å…³ç½‘ç«™å’ŒæœåŠ¡çš„ä½¿ç”¨æ¡æ¬¾ï¼Œä»¥åŠç›¸å…³æ•°æ®çš„å¤‡ä»½å·¥ä½œã€‚

---

## ğŸ“‹ æ›´æ–°æ—¥å¿—

æŸ¥çœ‹å®Œæ•´çš„ç‰ˆæœ¬å†å²å’Œæ›´æ–°å†…å®¹ï¼Œè¯·è®¿é—® [CHANGELOG.md](CHANGELOG.md)ã€‚

è¿ç§»å‰çš„ Puppeteer ç‰ˆæœ¬å·²åœ¨åˆ†æ”¯ä¸­ä¿ç•™ï¼Œä½†ä¸å½±å“ä½¿ç”¨çš„æƒ…å†µä¸‹ä¸ä¼šå†è¿›è¡Œæ›´æ–°å’Œä¿®å¤ï¼

---

**æ„Ÿè°¢ LMArena ã€Gemini ç­‰ç½‘ç«™æä¾›å›¾åƒç”ŸæˆæœåŠ¡ï¼** ğŸ‰
